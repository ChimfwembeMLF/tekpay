"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CanManageUsers = exports.CanViewAnalytics = exports.CanManageSystem = exports.CanManageClients = exports.ViewerOrAbove = exports.ManagerOrAbove = exports.AdminOnly = exports.RequireRole = exports.AdminAuth = void 0;
const common_1 = require("@nestjs/common");
const passport_1 = require("@nestjs/passport");
const admin_guard_1 = require("../guards/admin.guard");
const admin_user_entity_1 = require("../../auth/entities/admin-user.entity");
const swagger_1 = require("@nestjs/swagger");
const AdminAuth = () => (0, common_1.applyDecorators)((0, common_1.UseGuards)((0, passport_1.AuthGuard)('admin-jwt'), admin_guard_1.AdminGuard), (0, swagger_1.ApiBearerAuth)(), (0, swagger_1.ApiUnauthorizedResponse)({ description: 'Unauthorized' }), (0, swagger_1.ApiForbiddenResponse)({ description: 'Insufficient privileges' }));
exports.AdminAuth = AdminAuth;
const RequireRole = (role) => (0, common_1.SetMetadata)('adminRole', role);
exports.RequireRole = RequireRole;
const AdminOnly = () => (0, common_1.applyDecorators)((0, exports.RequireRole)(admin_user_entity_1.AdminRole.ADMIN), (0, exports.AdminAuth)());
exports.AdminOnly = AdminOnly;
const ManagerOrAbove = () => (0, common_1.applyDecorators)((0, exports.RequireRole)(admin_user_entity_1.AdminRole.MANAGER), (0, exports.AdminAuth)());
exports.ManagerOrAbove = ManagerOrAbove;
const ViewerOrAbove = () => (0, common_1.applyDecorators)((0, exports.RequireRole)(admin_user_entity_1.AdminRole.VIEWER), (0, exports.AdminAuth)());
exports.ViewerOrAbove = ViewerOrAbove;
const CanManageClients = () => (0, exports.ManagerOrAbove)();
exports.CanManageClients = CanManageClients;
const CanManageSystem = () => (0, exports.AdminOnly)();
exports.CanManageSystem = CanManageSystem;
const CanViewAnalytics = () => (0, exports.ViewerOrAbove)();
exports.CanViewAnalytics = CanViewAnalytics;
const CanManageUsers = () => (0, exports.AdminOnly)();
exports.CanManageUsers = CanManageUsers;
//# sourceMappingURL=admin.decorators.js.map